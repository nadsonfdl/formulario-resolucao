<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Gerar Resolu√ß√£o</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: 'Inter', sans-serif;
      margin: 0;
      padding: 0;
      background-color: #eef2f7;
    }

    .container {
      max-width: 1200px;
      margin: 30px auto;
      padding: 20px;
      background: #fff;
      border-radius: 16px;
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.07);
    }

    .header {
      background: linear-gradient(to right, #1e88e5, #42a5f5);
      padding: 30px;
      color: white;
      border-radius: 12px;
      text-align: center;
    }

    .header h1 {
      font-size: 2.2em;
      margin: 0;
    }

    .content {
      display: flex;
      flex-wrap: wrap;
      gap: 30px;
      margin-top: 30px;
    }

    .left-panel, .right-panel {
      flex: 1;
      min-width: 300px;
      background-color: #f9fafc;
      padding: 20px;
      border-radius: 12px;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.03);
    }

    h2 {
      font-size: 1.4em;
      color: #333;
      margin-bottom: 20px;
    }

    label {
      display: block;
      margin: 10px 0 5px;
      font-weight: 600;
    }

    textarea, .editable-box {
      width: 100%;
      min-height: 130px;
      padding: 15px;
      border: 1px solid #ccc;
      border-radius: 10px;
      font-size: 1em;
      resize: vertical;
      background: #fff;
      margin-bottom: 20px;
    }

    textarea:focus, .editable-box:focus {
      outline: none;
      border-color: #1e88e5;
    }

    button {
      background-color: #1e88e5;
      color: white;
      border: none;
      padding: 12px 24px;
      font-size: 1em;
      border-radius: 10px;
      cursor: pointer;
      transition: 0.3s;
    }

    button:hover {
      background-color: #1565c0;
    }

    .resolucao-area {
      margin-top: 40px;
      background-color: #f0f6ff;
      padding: 20px;
      border-radius: 12px;
    }

    .editable-box {
      background-color: #ffffff;
    }

    .footer {
      text-align: center;
      margin-top: 60px;
      padding: 20px;
      background-color: #333;
      color: white;
      border-radius: 0 0 12px 12px;
    }

    @media screen and (max-width: 768px) {
      .content {
        flex-direction: column;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>üìù Gerar Resolu√ß√£o de Atendimento</h1>
    </div>

    <div class="content">
      <div class="left-panel">
        <h2>Preencha as informa√ß√µes</h2>
        <label for="resumoConversa">üó£Ô∏è Resumo da conversa com o cliente:</label>
        <textarea id="resumoConversa" placeholder="Descreva aqui a conversa com o cliente..."></textarea>

        <label for="resumoTecnico">üîß Resumo t√©cnico do agente:</label>
        <textarea id="resumoTecnico" placeholder="Descreva as a√ß√µes que voc√™ tomou no atendimento..."></textarea>

        <button onclick="gerarResolucao()">‚ö° Gerar Resolu√ß√£o</button>
      </div>

      <div class="right-panel">
  <h2>üìö Guia de Preenchimento</h2>
  <p><strong>Use este guia para montar uma boa resolu√ß√£o t√©cnica. Veja os exemplos abaixo:</strong></p>
  <ul style="list-style: none; padding-left: 0;">
    <li>
      <strong>üß© 1. Quest√£o do Cliente:</strong><br>
      <em>Exemplo:</em> "O cliente deseja um relat√≥rio de informes de rendimentos Imposto de Renda ou informa√ß√µes sobre como gerar um relat√≥rio de notas geradas no ano anterior para um paciente, para fins de declara√ß√£o de imposto de renda."
    </li><br>
    <li>
      <strong>üîç 2. A√ß√µes Realizadas:</strong><br>
      <em>Exemplo:</em> "Foi orientado ao cliente que o sistema possui uma fun√ß√£o que emite automaticamente a declara√ß√£o do IR do paciente."
    </li><br>
    <li>
      <strong>üß≠ 3. Passo a Passo no Sistema:</strong><br>
      <em>Exemplo:</em> "Para emitir: acessar <strong>PRONTU√ÅRIO</strong> > clicar na <strong>setinha ao lado do bot√£o Paciente</strong> no canto superior direito > selecionar a op√ß√£o <strong>Declara√ß√£o IRPF</strong>."
    </li><br>
    <li>
      <strong>üõ†Ô∏è 4. A√ß√µes T√©cnicas (se aplic√°vel):</strong><br>
      <em>Exemplo:</em> "Verificada a base do cliente, fun√ß√£o ativa e sem inconsist√™ncias. Nenhuma interven√ß√£o t√©cnica foi necess√°ria."
    </li><br>
    <li>
      <strong>‚úÖ 5. Resultado Final:</strong><br>
      <em>Exemplo:</em> "Cliente orientado com sucesso e conseguiu emitir a declara√ß√£o sem dificuldades."
    </li>
  </ul>
  <p style="margin-top: 20px; color: #555;">
    ‚úèÔ∏è Utilize esses exemplos como base para descrever cada situa√ß√£o, adaptando conforme o atendimento.
  </p>
</div>
    </div>

    <!-- √Årea de visualiza√ß√£o da resolu√ß√£o -->
    <div id="resolucaoGerada" class="resolucao-area" style="display:none;">
      <h2>üìÑ Resolu√ß√£o Gerada (Edit√°vel)</h2>
      <div id="resolucaoTexto" class="editable-box" contenteditable="true"></div>
      <br>
      <button onclick="enviarParaSheets()">üì§ Enviar para Google Sheets</button>
    </div>
  </div>

  <div class="footer">
    Desenvolvido por Nadson - Analista de Suporte IGUT
  </div>

  <script>
    const openaiApiKey = 'SUA_CHAVE_DE_API_AQUI'; // Substitua com sua chave

    async function gerarResolucao() {
      const resumoConversa = document.getElementById('resumoConversa').value.trim();
      const resumoTecnico = document.getElementById('resumoTecnico').value.trim();

      if (!resumoConversa || !resumoTecnico) {
        alert("Por favor, preencha ambos os campos.");
        return;
      }

      const prompt = `
Resumo da conversa com o cliente: ${resumoConversa}
Resumo t√©cnico do agente: ${resumoTecnico}
Gere uma resolu√ß√£o clara, estruturada e profissional para documentar o atendimento realizado.
      `;

      const response = await fetch('https://api.openai.com/v1/completions', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
          'Authorization': `Bearer ${openaiApiKey}`
        },
        body: JSON.stringify({
          model: 'text-davinci-003',
          prompt: prompt,
          max_tokens: 200
        })
      });

      const data = await response.json();
      const resolucao = data.choices[0].text.trim();

      document.getElementById('resolucaoTexto').textContent = resolucao;
      document.getElementById('resolucaoGerada').style.display = 'block';
    }

    async function enviarParaSheets() {
      const resolucaoTexto = document.getElementById('resolucaoTexto').textContent.trim();

      if (!resolucaoTexto) {
        alert("A resolu√ß√£o est√° vazia.");
        return;
      }

      const response = await fetch('https://script.google.com/macros/s/AKfycbxsBYZtOkvgq132wPyyXhAXI0HhA1yghpYp6fRLa8Kf1RSd6IZk744K5ENP3QRK1AOr/exec', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify({ texto: resolucaoTexto })
      });

      const data = await response.json();
      if (data.success) {
        alert('‚úÖ Resolu√ß√£o enviada com sucesso!');
      } else {
        alert('‚ùå Erro ao enviar resolu√ß√£o.');
      }
    }
  </script>
</body>
</html>
