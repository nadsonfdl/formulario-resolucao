<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Gerador de Resumos e Resolu√ß√µes com IA</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
  <style>
    :root {
      --azul-principal: #00AFB7;
      --azul-escuro: #007E85;
      --cinza-claro: #f0f4f8;
      --branco: #ffffff;
      --texto: #333;
    }

    body {
      font-family: 'Inter', sans-serif;
      margin: 0;
      background-color: var(--cinza-claro);
    }

    .container {
      max-width: 1200px;
      margin: 30px auto;
      padding: 20px;
      background: var(--branco);
      border-radius: 16px;
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.07);
    }

    .header {
      background: linear-gradient(to right, var(--azul-principal), var(--azul-escuro));
      padding: 30px;
      color: var(--branco);
      border-radius: 12px;
      text-align: center;
    }

    .header h1 {
      margin: 0;
    }

    .content {
      display: flex;
      flex-wrap: wrap;
      gap: 30px;
      margin-top: 30px;
    }

    .left-panel, .right-panel {
      flex: 1;
      min-width: 300px;
      background-color: var(--cinza-claro);
      padding: 20px;
      border-radius: 12px;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.03);
    }

    label {
      font-weight: 600;
      display: block;
      margin-bottom: 5px;
    }

    textarea {
      width: 100%;
      padding: 15px;
      border: 1px solid #ccc;
      border-radius: 10px;
      font-size: 1em;
      resize: vertical;
      background: var(--branco);
      margin-bottom: 20px;
    }

    textarea:focus {
      outline: none;
      border-color: var(--azul-principal);
      box-shadow: 0 0 0 2px rgba(0, 175, 183, 0.3);
    }

    button {
      background-color: var(--azul-principal);
      color: var(--branco);
      border: none;
      padding: 12px 24px;
      font-size: 1em;
      border-radius: 10px;
      cursor: pointer;
      transition: 0.3s;
    }

    button:hover {
      background-color: var(--azul-escuro);
    }

    .resolucao-area {
      background-color: #e7f9fb;
      padding: 20px;
      border-radius: 12px;
      margin-top: 30px;
    }

    .modal {
      display: none;
      position: fixed;
      z-index: 999;
      left: 0; top: 0;
      width: 100%; height: 100%;
      background-color: rgba(0,0,0,0.5);
      align-items: center;
      justify-content: center;
    }

    .modal-content {
      background: var(--branco);
      padding: 20px;
      border-radius: 10px;
      max-width: 600px;
      width: 90%;
      box-shadow: 0 10px 25px rgba(0,0,0,0.2);
    }

    .footer {
      text-align: center;
      margin-top: 60px;
      padding: 20px;
      background-color: #333;
      color: white;
      border-radius: 0 0 12px 12px;
    }

    @media (max-width: 768px) {
      .content {
        flex-direction: column;
      }
    }
  </style>
</head>
<body>

<div class="container">
  <div class="header">
    <h1>üìù Gerador de Resumos e Resolu√ß√µes com IA</h1>
  </div>

  <div class="content">
    <div class="left-panel">
      <label for="questao">üß© Quest√£o do Cliente:</label>
      <textarea id="questao" placeholder="Descreva o que o cliente solicitou..."></textarea>

      <label for="resolucao">üîß Resolu√ß√£o do Agente:</label>
      <textarea id="resolucao" placeholder="Descreva como foi resolvido..."></textarea>

      <button onclick="gerarResumo()">‚ö° Gerar Resumo com IA</button>
    </div>

    <div class="right-panel">
      <h2>üìò Guia de Preenchimento</h2>
      <p><b>üß© Quest√£o do Cliente:</b> Explique claramente a solicita√ß√£o do cliente.</p>
      <p><b>üîß Resolu√ß√£o:</b> Informe como foi resolvido, o caminho no sistema e a√ß√µes realizadas.</p>
      <p><b>‚úÖ Resultado:</b> Registre o desfecho, se o problema foi resolvido e as orienta√ß√µes.</p>
    </div>
  </div>

  <div class="resolucao-area" id="areaResultado" style="display:none;">
    <h2>üìÑ Resolu√ß√£o Gerada</h2>
    <div id="textoResultado" contenteditable="true" style="background:white; padding:15px; border-radius:8px; border:1px solid #ccc;"></div>
    <br>
    <button onclick="abrirModal()">üëÅÔ∏è Visualizar e Editar</button>
  </div>
</div>

<!-- Modal -->
<div class="modal" id="modal">
  <div class="modal-content">
    <h3>üìù Editar Resolu√ß√£o Antes de Enviar</h3>
    <textarea id="textoModal" rows="10" style="width:100%; padding:10px; border-radius:8px; border:1px solid #ccc;"></textarea>
    <br><br>
    <button onclick="enviarParaSheets()">üõÑ Enviar para Google Sheets</button>
    <button onclick="fecharModal()" style="background-color:#888;">‚ùå Fechar</button>
  </div>
</div>

<div class="footer">
  Desenvolvido por Nadson - Analista de Suporte IGUT
</div>

<script>
const openaiKey = "SUA_API_OPENAI";
const googleSheetsURL = "URL_DO_SEU_WEBHOOK_GOOGLE_SHEETS";

async function gerarResumo() {
  const questao = document.getElementById("questao").value.trim();
  const resolucao = document.getElementById("resolucao").value.trim();

  if (!questao || !resolucao) {
    alert("Preencha os dois campos.");
    return;
  }

  const prompt = `
Gere uma resolu√ß√£o de atendimento profissional com este formato:

üìù Quest√£o do Cliente:
${questao}

üîß Solu√ß√£o Aplicada:
${resolucao}

‚úÖ Resultado Final:
Descreva se foi solucionado, o desfecho e qualquer orienta√ß√£o adicional.
`;

  const response = await fetch("https://api.openai.com/v1/chat/completions", {
    method: "POST",
    headers: {
      "Content-Type": "application/json",
      Authorization: `Bearer ${openaiKey}`
    },
    body: JSON.stringify({
      model: "gpt-3.5-turbo",
      messages: [{ role: "user", content: prompt }],
      temperature: 0.3,
      max_tokens: 800
    })
  });

  const data = await response.json();
  const resultado = data.choices[0].message.content;

  document.getElementById("textoResultado").innerText = resultado;
  document.getElementById("areaResultado").style.display = "block";
}

function abrirModal() {
  const texto = document.getElementById("textoResultado").innerText;
  document.getElementById("textoModal").value = texto;
  document.getElementById("modal").style.display = "flex";
}

function fecharModal() {
  document.getElementById("modal").style.display = "none";
}

async function enviarParaSheets() {
  const textoFinal = document.getElementById("textoModal").value.trim();

  if (!textoFinal) {
    alert("O texto est√° vazio.");
    return;
  }

  await fetch(googleSheetsURL, {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({
      resolucao: textoFinal,
      data: new Date().toLocaleString()
    })
  });

  alert("‚úÖ Enviado para Google Sheets com sucesso!");
  fecharModal();
}
</script>

</body>
</html>
